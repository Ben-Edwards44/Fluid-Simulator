To do:
- [ ] optimise particle lookups for density calculations
- [X] viscosity
- [ ] near density and near pressure